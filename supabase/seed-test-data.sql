-- ============================================
-- TEST DATA SEED SCRIPT
-- ============================================
-- Creates fake players and votes for testing
-- Run this in Supabase SQL Editor
-- ============================================

-- NOTE: This temporarily disables foreign key constraint
-- Only use this in development/testing!

-- 1. TEMPORARILY DISABLE FOREIGN KEY CONSTRAINT
alter table public.players drop constraint if exists players_user_id_fkey;

-- 2. CREATE TEST PLAYERS
-- These won't be able to sign in (no auth.users record)
-- But they'll show up in the app for testing
insert into public.players (user_id, discord_id, display_name, custom_name, avatar_url) values
  ('11111111-1111-1111-1111-111111111111', 'test001', 'Alice', 'Pro Alice', null),
  ('22222222-2222-2222-2222-222222222222', 'test002', 'Bob', null, null),
  ('33333333-3333-3333-3333-333333333333', 'test003', 'Charlie', 'Chuck', null),
  ('44444444-4444-4444-4444-444444444444', 'test004', 'Diana', null, null),
  ('55555555-5555-5555-5555-555555555555', 'test005', 'Eve', 'E-Money', null),
  ('66666666-6666-6666-6666-666666666666', 'test006', 'Frank', null, null),
  ('77777777-7777-7777-7777-777777777777', 'test007', 'Grace', 'Amazing Grace', null),
  ('88888888-8888-8888-8888-888888888888', 'test008', 'Henry', null, null)
on conflict (user_id) do nothing;

-- 3. RE-ENABLE FOREIGN KEY CONSTRAINT
alter table public.players 
add constraint players_user_id_fkey 
foreign key (user_id) references auth.users(id) on delete cascade;

-- 4. CREATE SOME TEST VOTES
-- Each player votes for a few others (realistic scenario)
insert into public.votes (voter_id, target_id, score) values
  -- Alice's votes
  ('11111111-1111-1111-1111-111111111111', '22222222-2222-2222-2222-222222222222', 8.50),
  ('11111111-1111-1111-1111-111111111111', '33333333-3333-3333-3333-333333333333', 7.25),
  ('11111111-1111-1111-1111-111111111111', '44444444-4444-4444-4444-444444444444', 9.00),
  ('11111111-1111-1111-1111-111111111111', '55555555-5555-5555-5555-555555555555', 6.75),
  
  -- Bob's votes
  ('22222222-2222-2222-2222-222222222222', '11111111-1111-1111-1111-111111111111', 9.50),
  ('22222222-2222-2222-2222-222222222222', '33333333-3333-3333-3333-333333333333', 6.00),
  ('22222222-2222-2222-2222-222222222222', '55555555-5555-5555-5555-555555555555', 7.50),
  ('22222222-2222-2222-2222-222222222222', '77777777-7777-7777-7777-777777777777', 8.25),
  
  -- Charlie's votes
  ('33333333-3333-3333-3333-333333333333', '11111111-1111-1111-1111-111111111111', 8.00),
  ('33333333-3333-3333-3333-333333333333', '22222222-2222-2222-2222-222222222222', 7.75),
  ('33333333-3333-3333-3333-333333333333', '44444444-4444-4444-4444-444444444444', 5.50),
  ('33333333-3333-3333-3333-333333333333', '88888888-8888-8888-8888-888888888888', 6.25),
  
  -- Diana's votes
  ('44444444-4444-4444-4444-444444444444', '11111111-1111-1111-1111-111111111111', 9.25),
  ('44444444-4444-4444-4444-444444444444', '22222222-2222-2222-2222-222222222222', 8.75),
  ('44444444-4444-4444-4444-444444444444', '55555555-5555-5555-5555-555555555555', 7.00),
  
  -- Eve's votes
  ('55555555-5555-5555-5555-555555555555', '11111111-1111-1111-1111-111111111111', 8.50),
  ('55555555-5555-5555-5555-555555555555', '33333333-3333-3333-3333-333333333333', 7.25),
  ('55555555-5555-5555-5555-555555555555', '66666666-6666-6666-6666-666666666666', 6.50),
  ('55555555-5555-5555-5555-555555555555', '77777777-7777-7777-7777-777777777777', 9.00),
  
  -- Frank's votes
  ('66666666-6666-6666-6666-666666666666', '22222222-2222-2222-2222-222222222222', 7.50),
  ('66666666-6666-6666-6666-666666666666', '44444444-4444-4444-4444-444444444444', 8.25),
  ('66666666-6666-6666-6666-666666666666', '77777777-7777-7777-7777-777777777777', 8.75),
  
  -- Grace's votes
  ('77777777-7777-7777-7777-777777777777', '11111111-1111-1111-1111-111111111111', 9.75),
  ('77777777-7777-7777-7777-777777777777', '22222222-2222-2222-2222-222222222222', 8.00),
  ('77777777-7777-7777-7777-777777777777', '33333333-3333-3333-3333-333333333333', 7.50),
  ('77777777-7777-7777-7777-777777777777', '55555555-5555-5555-5555-555555555555', 8.50),
  
  -- Henry's votes
  ('88888888-8888-8888-8888-888888888888', '11111111-1111-1111-1111-111111111111', 8.25),
  ('88888888-8888-8888-8888-888888888888', '33333333-3333-3333-3333-333333333333', 6.75),
  ('88888888-8888-8888-8888-888888888888', '66666666-6666-6666-6666-666666666666', 7.00)
on conflict (voter_id, target_id) do nothing;

-- ============================================
-- DONE! You now have 8 test players with ~30 votes
-- ============================================
-- To see them:
-- SELECT * FROM player_ratings ORDER BY avg_score DESC;
--
-- To clean up:
-- See cleanup-test-data.sql
-- ============================================

